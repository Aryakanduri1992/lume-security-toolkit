{
  "rules": [
    {
      "tool": "nmap",
      "patterns": [
        "scan.*port",
        "port.*scan",
        "find.*open.*port",
        "check.*port",
        "network.*scan",
        "scan.*host",
        "discover.*service",
        "scan.*\\d+\\.\\d+\\.\\d+\\.\\d+",
        "scan of",
        "scan\\s+\\d+\\.\\d+\\.\\d+\\.\\d+",
        "nmap"
      ],
      "command": "nmap -sV -T4 {target}",
      "description": "Scan target for open ports and services",
      "warning": "Port scanning may trigger IDS/IPS systems. Ensure you have authorization.",
      "summary": "Performed a service and version scan on the target",
      "impact": "Identified open ports and detected running network services for further analysis"
    },
    {
      "tool": "nmap",
      "patterns": [
        "scan.*network",
        "find.*live.*host",
        "discover.*host",
        "ping.*sweep",
        "network.*discover"
      ],
      "command": "nmap -sn {target}/24",
      "description": "Discover live hosts on network",
      "warning": "Network scanning may be detected. Ensure you have authorization.",
      "summary": "Performed network discovery to identify active hosts",
      "impact": "Mapped live systems on the network for reconnaissance"
    },
    {
      "tool": "gobuster",
      "patterns": [
        "find.*director",
        "enumerate.*director",
        "directory.*brute",
        "find.*hidden.*page",
        "discover.*path",
        "find.*admin.*page",
        "find.*page",
        "find.*path",
        "gobuster",
        "dir.*enum"
      ],
      "command": "gobuster dir -u {target} -w {wordlist} -t 50",
      "description": "Enumerate directories and files on web server",
      "warning": "Directory brute-forcing generates significant traffic. Use responsibly.",
      "summary": "Performed directory and file enumeration on web server",
      "impact": "Discovered hidden paths, admin panels, and accessible web resources"
    },
    {
      "tool": "gobuster",
      "patterns": [
        "find.*subdomain",
        "enumerate.*subdomain",
        "subdomain.*brute",
        "discover.*subdomain",
        "subdomain.*enum",
        "dns.*enum"
      ],
      "command": "gobuster dns -d {target} -w /usr/share/wordlists/dnsmap.txt -t 50",
      "description": "Enumerate subdomains",
      "warning": "DNS enumeration may be logged. Ensure you have authorization.",
      "summary": "Performed subdomain enumeration on target domain",
      "impact": "Identified additional subdomains and expanded attack surface"
    },
    {
      "tool": "nikto",
      "patterns": [
        "scan.*web.*vulnerabilit",
        "web.*server.*scan",
        "check.*web.*security",
        "nikto.*scan",
        "nikto",
        "web.*vuln",
        "scan.*web"
      ],
      "command": "nikto -h {target}",
      "description": "Scan web server for vulnerabilities",
      "warning": "Nikto scans are noisy and easily detected. Use with caution.",
      "summary": "Performed comprehensive web vulnerability scan",
      "impact": "Identified web server misconfigurations, outdated software, and potential vulnerabilities"
    },
    {
      "tool": "sqlmap",
      "patterns": [
        "sql.*injection",
        "test.*sql.*injection",
        "check.*sql.*vuln",
        "sqlmap",
        "sql.*test",
        "test.*sql",
        "sqli"
      ],
      "command": "sqlmap -u {target} --batch --banner",
      "description": "Test for SQL injection vulnerabilities",
      "warning": "SQL injection testing may damage databases. Only test authorized systems.",
      "summary": "Tested target for SQL injection vulnerabilities",
      "impact": "Assessed database security and identified potential injection points"
    },
    {
      "tool": "hydra",
      "patterns": [
        "brute.*force.*ssh",
        "crack.*ssh.*password",
        "brute.*ssh",
        "hydra.*ssh",
        "password.*crack.*ssh"
      ],
      "command": "hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/rockyou.txt {target} {service}",
      "description": "Brute force authentication",
      "warning": "Brute force attacks may lock accounts and are easily detected. Use carefully.",
      "summary": "Performed brute force attack on SSH authentication",
      "impact": "Tested password strength and attempted credential discovery"
    },
    {
      "tool": "hydra",
      "patterns": [
        "brute.*force.*ftp",
        "crack.*ftp.*password",
        "brute.*ftp",
        "hydra.*ftp",
        "password.*crack.*ftp"
      ],
      "command": "hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/rockyou.txt {target} {service}",
      "description": "Brute force FTP authentication",
      "warning": "Brute force attacks may lock accounts and are easily detected. Use carefully.",
      "summary": "Performed brute force attack on FTP authentication",
      "impact": "Tested FTP password strength and attempted credential discovery"
    },
    {
      "tool": "metasploit",
      "patterns": [
        "exploit.*eternal.*blue",
        "ms17.*010",
        "smb.*exploit",
        "eternalblue",
        "metasploit",
        "msf"
      ],
      "command": "msfconsole -q -x 'use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS {target}; check; exit'",
      "description": "Check for EternalBlue vulnerability (MS17-010)",
      "warning": "Exploitation can crash systems. Only use on authorized test systems.",
      "summary": "Checked target for EternalBlue (MS17-010) vulnerability",
      "impact": "Assessed critical SMB vulnerability that could allow remote code execution"
    },
    {
      "tool": "nmap",
      "patterns": [
        "os.*detection",
        "detect.*operating.*system",
        "fingerprint.*os",
        "identify.*os",
        "detect.*os",
        "os.*scan"
      ],
      "command": "nmap -O {target}",
      "description": "Detect operating system",
      "warning": "OS detection requires root privileges and may be detected.",
      "summary": "Performed operating system detection and fingerprinting",
      "impact": "Identified target OS type and version for targeted exploitation"
    },
    {
      "tool": "nmap",
      "patterns": [
        "vulnerability.*scan",
        "vuln.*scan",
        "check.*vulnerabilit",
        "scan.*vuln",
        "find.*vuln"
      ],
      "command": "nmap --script vuln {target}",
      "description": "Scan for known vulnerabilities using NSE scripts",
      "warning": "Vulnerability scanning may trigger security alerts.",
      "summary": "Performed vulnerability scan using Nmap NSE scripts",
      "impact": "Identified known CVEs and security weaknesses in target services"
    },
    {
      "tool": "whatweb",
      "patterns": [
        "identify.*web.*technolog",
        "fingerprint.*web",
        "detect.*cms",
        "what.*web.*server",
        "whatweb",
        "web.*tech",
        "identify.*tech"
      ],
      "command": "whatweb {target}",
      "description": "Identify web technologies and CMS",
      "warning": "Web fingerprinting is generally safe but may be logged.",
      "summary": "Identified web technologies, frameworks, and CMS platform",
      "impact": "Gathered intelligence on web stack for targeted vulnerability research"
    }
  ]
}
